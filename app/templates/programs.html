{% macro render_programs(programs, show_date, show_duration, show_rec_status) %}
  <table class="table">
    <thead>
      <th>Title</th>
      <th>Episode</th>
      {% if show_date %}
        <th colspan="3">Date</th>
      {% endif %}
      {% if show_duration %}
        <th>Duration</th>
      {% endif %}
      {% if show_rec_status %}
        <th>Status</th>
      {% endif %}
    </thead>
    <tbody>
      {% for p in programs %}
        {% if p.recstatus is not none %}
          <tr>
            <td style="width: 300px">{{ p.title }}</td>
            <td style="width: 450px">
              {% if p.subtitle %}
                {{ p.subtitle }}<br />
              {% endif %}
              {% if p.description %}
                <small>{{ p.description }}</small>
              {% endif %}
            </td>
            {% if show_date %}
              {% if p.startime is not none %}
                {% if p.starttime.date() == today %}
                  <td>Today</td>
                  <td>{{ p.starttime.strftime('%I:%M:%S %p') }}</td>
                  <td></td>
                {% else %}
                  <td>{{ p.starttime.strftime('%A') }}</td>
                  <td>{{ p.starttime.strftime('%I:%M:%S %p') }}</td>
                  <td>{{ p.starttime.strftime('%B %d, %Y') }}</td>
                {% endif %}
              {% else %}
                {% if p.progstart.date() == today %}
                  <td>Today</td>
                  <td>{{ p.progstart.strftime('%I:%M:%S %p') }}</td>
                  <td></td>
                {% else %}
                  <td>{{ p.progstart.strftime('%A') }}</td>
                  <td>{{ p.progstart.strftime('%I:%M:%S %p') }}</td>
                  <td>{{ p.progstart.strftime('%B %d, %Y') }}</td>
                {% endif %}
              {% endif %}
            {% endif %}
            {% if show_rec_status %}
              <td>
                {% if p.recstatus == 3 %}
                  Already Recorded
                {% else %}
                  {% if p.recstatus == 4 %}
                    Earlier Showing
                  {% else %}
                    {{ p.recstatus }}
                  {% endif %}
                {% endif %}
              </td>
            {% endif %}
            {% if show_duration %}
              <td>
                {{ (p.endtime - p.starttime) | string }}
              </td>
            {% endif %}
          </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
{% endmacro %}
